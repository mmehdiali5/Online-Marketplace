// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace OnlineMarketPlace.Pages
{
    #line hidden
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 2 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\_Imports.razor"
using System.Net.Http.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\_Imports.razor"
using Microsoft.AspNetCore.Components.WebAssembly.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\_Imports.razor"
using OnlineMarketPlace;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\_Imports.razor"
using OnlineMarketPlace.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\_Imports.razor"
using OnlineMarketPlace.Controls;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\_Imports.razor"
using System.ComponentModel.DataAnnotations;

#line default
#line hidden
#nullable disable
#nullable restore
#line 14 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\_Imports.razor"
using Blazored.SessionStorage;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\Pages\HomePage.razor"
using Newtonsoft.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\Pages\HomePage.razor"
using Newtonsoft.Json.Linq;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\Pages\HomePage.razor"
using OnlineMarketPlace.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\Pages\HomePage.razor"
using System;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\Pages\HomePage.razor"
using System.Collections.Generic;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\Pages\HomePage.razor"
using System.Linq;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\Pages\HomePage.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\Pages\HomePage.razor"
using System.Threading.Tasks;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\Pages\HomePage.razor"
using System.Threading;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/")]
    public partial class HomePage : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 339 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\Pages\HomePage.razor"
      
    bool ShowOnlyFilteredProducts = false;
    int categoryIdClickedFromChild = -1;

    List<Category> allCategoriesDataForFilterComponenent = new List<Category>();
    public class ItemData
    {
        public Item item;
        public string imgPath;
    }

    public class ListData
    {
        public Category category;

        public List<ItemData> itemsList = new List<ItemData>();
    }
    List<ListData> allListItems = new List<ListData>();

    //    List<Item> allItemList = new List<Item>();

    List<Item> list = new List<Item>();
    protected override async Task<Task> OnInitializedAsync()
    {
        List<Category> allCategoriesList = new List<Category>();
        JArray result = new JArray();
        Console.WriteLine("In On Initialized");
        result = await GetResponse("category");
        Console.WriteLine("Hello");

        allCategoriesList = ConvertJsonArrayToList<Category>(result);
        allCategoriesDataForFilterComponenent = allCategoriesList;
        foreach (var category in allCategoriesList)
        {
            result = await GetResponse("item", "CategoryId", category.Id);
            List<Item> allItemsRelatedToCategory = ConvertJsonArrayToList<Item>(result);
            List<ItemData> itemDataList = new List<ItemData>();
            foreach (var item in allItemsRelatedToCategory)
            {
                result = await GetResponse("image", "ItemId", item.Id);
                String imgPath = ConvertJsonArrayToList<Image>(result).ElementAt(0).Path;
                itemDataList.Add(new ItemData { item = item, imgPath = imgPath });
            }
            Console.WriteLine("Result: " + result);
            allListItems.Add(new ListData { category = category, itemsList = itemDataList });
        }
        return base.OnInitializedAsync();
    }

    async Task<JArray> GetResponse(string table)
    {
        

#line default
#line hidden
#nullable disable
#nullable restore
#line 392 "C:\Users\Muhammad Mehdi Ali\Desktop\PUCIT Files\6th Semester\EAD\EAD-Project\EAD-Project\OnlineMarketPlace\OnlineMarketPlace\Pages\HomePage.razor"
            String jsonDataAsString;
    Console.Write("In GetResponse(table)");
    HttpClient http = new HttpClient();
    var requestMessage = new HttpRequestMessage()
    {
        Method = new HttpMethod("GET"),
        RequestUri = new Uri("http://localhost:5000/odata/" + table)
    };
    var response = await http.SendAsync(requestMessage);
    jsonDataAsString = await response.Content.ReadAsStringAsync();
    Console.WriteLine(jsonDataAsString);
    var data = (JObject)JsonConvert.DeserializeObject(jsonDataAsString);
    return (JArray)data["value"];
}
async Task<JArray> GetResponse(string table, string field, int id)
{
    String jsonDataAsString;
    Console.Write("In GetResponse(table)");
    HttpClient http = new HttpClient();
    var requestMessage = new HttpRequestMessage()
    {
        Method = new HttpMethod("GET"),
        RequestUri = new Uri("http://localhost:5000/odata/" + table + "?$filter=" + field + " eq " + id)
    };
    var response = await http.SendAsync(requestMessage);
    jsonDataAsString = await response.Content.ReadAsStringAsync();
    Console.WriteLine(jsonDataAsString);
    var data = (JObject)JsonConvert.DeserializeObject(jsonDataAsString);
    return (JArray)data["value"];
}

async Task<List<T>> GetList<T>(string fieldName, int categoryId)
{
    JArray result = new JArray();
    string table = typeof(T).Name;
    result = await GetResponse(table, fieldName, categoryId);
    return ConvertJsonArrayToList<T>(result);
}
public List<T> ConvertJsonArrayToList<T>(JArray jsonArray)
{
    Console.WriteLine("array" + jsonArray);
    List<T> list = jsonArray.ToObject<List<T>>();
    return list;
}

private void GetCategoryId(int id)
{
    ShowOnlyFilteredProducts = true;
    categoryIdClickedFromChild = id;
}


#line default
#line hidden
#nullable disable
    }
}
#pragma warning restore 1591
